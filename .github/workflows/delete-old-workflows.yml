on:
#  push:
#    branches:
#      - "main"
  workflow_dispatch: #Please remove this line
      
jobs:

  delete-old-workflow-runs:
    runs-on: ubuntu-latest
    steps:
#      - name: Check out
#        uses: actions/checkout@v3
      - name: Create root directory
        run: |
          mkdir disable-circleci
          cd disable-circleci
      - name: Enable Github actions workflows
        shell: bash
        continue-on-error: true
        env:
         GH_TOKEN: ${{ secrets.CD_PAT }}
        run: |
          echo "Get workflows runs id"
          gh api \
          -H "Accept: application/vnd.github+json" \
          /repos/amornc/switch/actions/runs >> runs-id.txt
          file="runs-id.txt"
          while read -r line; do
              echo "Delete old workflows runs"
              gh api \
              --method DELETE \
              -H "Accept: application/vnd.github+json" \
              /repos/amornc/switch/actions/runs/$line
              echo "################################################################"
          done <$file

